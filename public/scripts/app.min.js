/*! basic-bootstrap 2016-01-31 */
!function(a){a(function(){var b="public/data/LearnHub.json",c=null,d=a("#course-count .count"),e=a("button#search.btn"),f=a(".course-container");d.on("course-available",function(b,c){a(this).html(c)});var g=function(){var b=a("form#category-form :checkbox"),d=[],e=!0;b.each(function(c,f){a(b[c]).is(":checked")&&(e=!1,d.push(a(b[c]).val()))});var f=[];return c.items.forEach(function(a){d.forEach(function(b){a.category.toLowerCase().contains(b.toLowerCase())&&f.push(a)})}),f=e?c.items:f,console.log(f.length),f};a("form#category-form").on("click",":checkbox",function(){l(g())});var h=a("#sort-by-ratings"),i=a("#sort-by-cost");h.on("click",function(){var a=j(),b=a.sort(function(a,b){return b.rating-a.rating});l(b)}),i.on("click",function(){var a=j(),b=a.sort(function(a,b){var c=a.cost,d=b.cost;return 0==c?c=0:(c=c.replace(/^\D+|\D+$/g,"").split(".")[0].split(","),c=parseInt(c[0]+c[1])),0==d?d=0:(d=d.replace(/^\D+|\D+$/g,"").split(".")[0].split(","),d=parseInt(d[0]+d[1])),c-d});l(b)});var j=function(){var b=a("#searchCriterion").val().toLowerCase(),c=g();return c=c.filter(function(a){return a.title.toLowerCase().contains(b)})},k=function(){l(j())};e.on("click",k),a("#searchCriterion").on("change input",k),a.getJSON(b).done(function(a){c=a[0],c.items=[];var b=0;for(var d in c.titles)c.items[b]={},c.items[b].id=d,c.items[b].title=c.titles[d],c.items[b].rating=c.ratings[d],c.items[b].image=c.images[d],c.items[b].category=c.categories[d],c.items[b].level=c.levels[d],c.items[b].detail=c.details[d],c.items[b].cost=c.costs[d],c.items[b].extLink=c.extLinks[d],b++;l(c.items)}).fail(function(a,b,c){console.error("ERROR: "+b+", "+c)}).always(function(){console.log("Finished.")});var l=function(b){f.html("");for(var c=function(b){var c=a('<div class="col-md-3"><div class="container-fluid"></div></div>'),d=a('<div class="row image"></div>'),e=a('<div class="row"><div class="container-fluid"><div class="row ratingAndLink"></div></div></div>'),f=a('<div class="col-md-6 rating"></div>'),g=a('<div class="col-md-6 extLink"></div>'),h=a('<img src="'+b.image+'"/>');h.appendTo(d);for(var i=0;5>i;i++)i<Math.floor(b.rating)?f.append('<i class="fa fa-star"></i>'):i===Math.floor(b.rating)&&2*b.rating%2===1?f.append('<i class="fa fa-star-half-o"></i>'):f.append('<i class="fa fa-star-o"></i>');return f.data("rating",b.rating),f.appendTo(e),g.html('<a href="'+b.extLink+'" title="'+b.extLink+'">Link <i class="fa fa-external-link"></i></a>'),g.appendTo(e),d.appendTo(c),e.appendTo(c),c},e=function(b){var c=a('<div class="col-md-7 course-details"><div class="container-fluid"></div></div>'),d=a('<div class="row course-title"><div class="title"></div></div>'),e=a('<div class="row course-detail"><div class="detail"></div></div>');return e.text(b.detail),d.text(b.title),d.appendTo(c),e.appendTo(c),c},g=function(b){var c=a('<div class="col-md-2"><div class="container-fluid"></div></div>'),d=a('<div class="row expertise-level ribbon"></div>');d.text(b.level);var e=a('<div class="row cost"></div>');return 0==b.cost?e.text("Free"):e.text(b.cost),d.appendTo(c),e.appendTo(c),c},h=function(b){var d=a('<div class="row course" id="'+b.id+'"></div>');return c(b).appendTo(d),e(b).appendTo(d),g(b).appendTo(d),d},i=0,j=b.length;j>i;i++)h(b[i]).appendTo(f);d.trigger("course-available",[j])}})}(jQuery);